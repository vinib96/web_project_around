(()=>{"use strict";class e{constructor(e,t,o){this._link=e.link,this._name=e.name,this._cardSelector=t,this._handleClick=o}_getTemplate(){return document.querySelector("#cards").content.querySelector(".elements__cards").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._like(),this._remove(),this._element.querySelector(".elements__card-image").src=this._link,this._element.querySelector(".elements__text").alt=this._name,this._element.querySelector(".elements__text").textContent=this._name,this._element}_like(){const e=this._element.querySelector(".elements__like-button");e.addEventListener("click",(()=>{e.classList.toggle("elements__like-button_click")}))}_remove(){const e=this._element.querySelector(".elements__trash");e.addEventListener("click",(()=>{e.closest(".elements__cards").remove()}))}_setEventListeners(){this._element.querySelector(".elements__card-image").addEventListener("click",(()=>{this._handleClick({link:this._link,name:this._name})}))}}class t{constructor(e,t){this._config=e,this._formElement=t}_showInputError(e,t){const o=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._config.inputErrorClass),o.textContent=t,o.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.add("text-color"),e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(e,t){console.log(this._hasInvalidInput(e)),this._hasInvalidInput(e)?t.classList.add(this._config.inactiveButtonClass):t.classList.remove(this._config.inactiveButtonClass)}_setEventListeners(){const e=this._formElement.querySelector(this._config.submitButtonSelector),t=Array.from(this._formElement.querySelectorAll(this._config.inputSelector));this._toggleButtonState(t,e),t.forEach((o=>{o.addEventListener("input",(()=>{this._checkInputValidity(o),this._toggleButtonState(t,e)}))}))}enableValidation(){Array.from(document.querySelectorAll(this._config.formSelector)).forEach((e=>{e.addEventListener("submit",(function(e){e.preventDefault()})),Array.from(this._formElement.querySelectorAll(".popup__formset")).forEach((e=>{this._setEventListeners(e)}))}))}}const o=document.querySelector(".popup_add-cards"),s=new t({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},document.querySelector(".popup_profile"));new t({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},o).enableValidation(),s.enableValidation();class n{constructor(e){this._popupSelector=e,this.close=this.close.bind(this)}open(){this._popupSelector.classList.add("popup__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupSelector.querySelector(".popup__close-button").addEventListener("click",this.close),this._popupSelector.addEventListener("click",(function(e){e.target.classList.remove("popup__opened")}))}}class r extends n{constructor({popupSelector:e,handleFormSubmit:t}){super(e),this._handleFormSubmit=t}_getInputValues(){return this._inputList=this._popupSelector.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}close(){super.close(),this._popupSelector.querySelector(".popup__form").reset()}setEventListeners(){super.setEventListeners(),this._popupSelector.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}}const i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),c=document.querySelector(".popup_profile"),u=document.querySelector(".popup_add-cards"),a=(c.querySelector(".popup__close-button"),u.querySelector(".popup__close-add"),document.querySelector(".profile__name"),document.querySelector(".profile__about"),document.querySelector(".popup__input_type_name")),p=document.querySelector(".popup__input_type_about"),_=(document.querySelector(".popup__form_profile"),document.querySelector(".popup_full")),m=document.querySelector(".elements__container"),d=(document.querySelector(".popup__container"),document.querySelector("#cards-form"),document.querySelector("#add-card"),document.querySelector(".profile__input"),document.querySelector(".elements__card-image"),new class extends n{constructor(e){super(e)}open(e,t){this._popupSelector.querySelector(".popup__image-large").src=e,this._popupSelector.querySelector(".popup__image-large").alt=t,this._popupSelector.querySelector(".popup__text-sub").textContent=t,super.open()}close(){super.close()}}(_));d.setEventListeners();const h=new class{constructor({items:e,renderer:t},o){this._renderedItems=e,this._renderer=t,this._class=o}addItem(e){this._class.append(e)}clear(){this._class.innerHTML=""}renderItems(){this.clear(),this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Vale de Yosemite",link:"https://practicum-content.s3.us-west-1.amazonaws.com/web-code/moved_yosemite.jpg"},{name:"Lago Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/web-code/moved_lake-louise.jpg"},{name:"Montanhas Carecas",link:"https://practicum-content.s3.us-west-1.amazonaws.com/web-code/moved_bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/web-code/moved_latemar.jpg"},{name:"Parque Nacional da Vanoise ",link:"https://practicum-content.s3.us-west-1.amazonaws.com/web-code/moved_vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/web-code/moved_lago.jpg"}],renderer:t=>{const o=new e(t,"#cards",(()=>{d.open(t.link,t.name)})).generateCard();h.addItem(o)}},m);h.renderItems();const S=new class{constructor({nameSelector:e,aboutSelector:t}){this._nameElement=document.querySelector(e),this._aboutElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,about:this._aboutElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._aboutElement.textContent=t}}({nameSelector:".profile__name",aboutSelector:".profile__about"}),y=new r({popupSelector:c,handleFormSubmit:({name:e,about:t})=>{S.setUserInfo(e,t)}});y.setEventListeners(),i.addEventListener("click",(()=>{const{name:e,about:t}=S.getUserInfo();a.value=e,p.value=t,y.open()}));const v=new r({popupSelector:u,handleFormSubmit:()=>{const t={name:document.querySelector(".popup__input_type_title").value,link:document.querySelector(".popup__input_type_image").value},o=new e(t,"#cards",(()=>{d.open(t.link,t.name)})).generateCard();document.querySelector(".elements__container").prepend(o)}});v.setEventListeners(),l.addEventListener("click",(()=>{v.open()}))})();